{% extends "base.html" %}
{% block title %}ã‚«ãƒ«ãƒ†ç·¨é›† | KARiN.{% endblock %}

{% block content %}
<h2 class="admin-title">âœ ã‚«ãƒ«ãƒ†ç·¨é›†</h2>

{% if get_flashed_messages() %}
  {% for message in get_flashed_messages(with_categories=true) %}
    <div class="admin-alert admin-alert-{{ message[0] }}" style="margin-bottom: 20px; padding: 12px; border-radius: 8px; background: {% if message[0] == 'success' %}#d4edda{% else %}#f8d7da{% endif %}; color: {% if message[0] == 'success' %}#155724{% else %}#721c24{% endif %};">
      {{ message[1] }}
    </div>
  {% endfor %}
{% endif %}

<form method="POST" action="/admin/karte/{{ patient.id }}/edit" style="max-width: 800px;">
  <div style="margin-bottom: 20px;">
    <label class="form-field" style="display: block; margin-bottom: 6px; font-weight: 600; color: #1E3A5F;">åå‰</label>
    <input type="text" name="name" value="{{ patient.name or '' }}" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;">
  </div>
  
  <div style="margin-bottom: 20px;">
    <label class="form-field" style="display: block; margin-bottom: 6px; font-weight: 600; color: #1E3A5F;">ãƒ•ãƒªã‚¬ãƒŠ</label>
    <input type="text" name="kana" value="{{ patient.kana or '' }}" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;">
  </div>
  
  <div style="margin-bottom: 20px;">
    <label class="form-field" style="display: block; margin-bottom: 6px; font-weight: 600; color: #1E3A5F;">ç”Ÿå¹´æœˆæ—¥</label>
    <input type="date" name="birthday" value="{{ patient.birthday or '' }}" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;">
  </div>
  
  <div style="margin-bottom: 20px;">
    <label class="form-field" style="display: block; margin-bottom: 6px; font-weight: 600; color: #1E3A5F;">æ€§åˆ¥</label>
    <select name="gender" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;">
      <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
      <option value="ç”·æ€§" {% if patient.gender == 'ç”·æ€§' %}selected{% endif %}>ç”·æ€§</option>
      <option value="å¥³æ€§" {% if patient.gender == 'å¥³æ€§' %}selected{% endif %}>å¥³æ€§</option>
      <option value="ãã®ä»–" {% if patient.gender == 'ãã®ä»–' %}selected{% endif %}>ãã®ä»–</option>
    </select>
  </div>
  
  <div style="margin-bottom: 20px;">
    <label class="form-field" style="display: block; margin-bottom: 6px; font-weight: 600; color: #1E3A5F;">åŒºåˆ†</label>
    <select name="category" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;">
      <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
      <option value="ä¸€èˆ¬" {% if patient.category == 'ä¸€èˆ¬' %}selected{% endif %}>ä¸€èˆ¬</option>
      <option value="ã‚¹ãƒãƒ¼ãƒ„é¸æ‰‹" {% if patient.category == 'ã‚¹ãƒãƒ¼ãƒ„é¸æ‰‹' %}selected{% endif %}>ã‚¹ãƒãƒ¼ãƒ„é¸æ‰‹</option>
      <option value="ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆ" {% if patient.category == 'ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆ' %}selected{% endif %}>ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆ</option>
    </select>
  </div>
  
  <div style="margin-bottom: 20px;">
    <label class="form-field" style="display: block; margin-bottom: 6px; font-weight: 600; color: #1E3A5F;">é›»è©±ç•ªå·</label>
    <input type="text" name="phone" value="{{ patient.phone or '' }}" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;">
  </div>
  
  <div style="margin-bottom: 20px;">
    <label class="form-field" style="display: block; margin-bottom: 6px; font-weight: 600; color: #1E3A5F;">ãƒ¡ãƒ¼ãƒ«</label>
    <input type="email" name="email" value="{{ patient.email or '' }}" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;">
  </div>
  
  <div style="margin-bottom: 20px;">
    <label class="form-field" style="display: block; margin-bottom: 6px; font-weight: 600; color: #1E3A5F;">éƒµä¾¿ç•ªå·</label>
    <input type="text" name="postal_code" value="{{ patient.postal_code or '' }}" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;">
  </div>
  
  <div style="margin-bottom: 20px;">
    <label class="form-field" style="display: block; margin-bottom: 6px; font-weight: 600; color: #1E3A5F;">ä½æ‰€</label>
    <input type="text" name="address" value="{{ patient.address or '' }}" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;">
  </div>
  
  <div style="margin-bottom: 20px;">
    <label class="form-field" style="display: block; margin-bottom: 6px; font-weight: 600; color: #1E3A5F;">ç´¹ä»‹è€…ï¼ˆè‡ªç”±è¨˜å…¥ï¼‰</label>
    <input type="text" name="introducer" value="{{ patient.introducer or '' }}" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;">
  </div>
  
  <div style="margin-bottom: 20px;">
    <label class="form-field" style="display: block; margin-bottom: 6px; font-weight: 600; color: #1E3A5F;">ç´¹ä»‹è€…ï¼ˆæ‚£è€…IDã§ç´ä»˜ã‘ï¼‰</label>
    <select name="introduced_by_patient_id" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;">
      <option value="">é¸æŠãªã—</option>
      {% for p in all_patients %}
        <option value="{{ p.id }}" {% if patient.introduced_by_patient_id == p.id %}selected{% endif %}>{{ p.id }}ï¼š{{ p.name }}ï¼ˆ{{ p.kana }}ï¼‰</option>
      {% endfor %}
    </select>
  </div>
  
  <div style="margin-bottom: 20px;">
    <label class="form-field" style="display: block; margin-bottom: 6px; font-weight: 600; color: #1E3A5F;">ä¸»è¨´</label>
    <textarea name="chief_complaint" rows="3" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;">{{ patient.chief_complaint or '' }}</textarea>
  </div>
  
  <div style="margin-bottom: 20px;">
    <label class="form-field" style="display: block; margin-bottom: 6px; font-weight: 600; color: #1E3A5F;">å¿ƒç–¾æ‚£</label>
    <input type="text" name="heart" value="{{ patient.heart or '' }}" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;" placeholder="å¿ƒç–¾æ‚£ã®æœ‰ç„¡">
  </div>
  
  <div style="margin-bottom: 20px;">
    <label class="form-field" style="display: block; margin-bottom: 6px; font-weight: 600; color: #1E3A5F;">å¦Šå¨ ä¸­ãƒ»å¯èƒ½æ€§ã‚ã‚Š</label>
    <input type="text" name="pregnant" value="{{ patient.pregnant or '' }}" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;" placeholder="å¦Šå¨ ã®æœ‰ç„¡">
  </div>
  
  <div style="margin-bottom: 20px;">
    <label class="form-field" style="display: block; margin-bottom: 6px; font-weight: 600; color: #1E3A5F;">æ…¢æ€§ç–¾æ‚£</label>
    <input type="text" name="chronic" value="{{ patient.chronic or '' }}" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;" placeholder="æ…¢æ€§ç–¾æ‚£ã®æœ‰ç„¡">
  </div>
  
  <div style="margin-bottom: 20px;">
    <label class="form-field" style="display: block; margin-bottom: 6px; font-weight: 600; color: #1E3A5F;">æ‰‹è¡“æ­´</label>
    <input type="text" name="surgery" value="{{ patient.surgery or '' }}" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;" placeholder="æ‰‹è¡“æ­´ã®æœ‰ç„¡">
  </div>
  
  <div style="margin-bottom: 20px;">
    <label class="form-field" style="display: block; margin-bottom: 6px; font-weight: 600; color: #1E3A5F;">åŒ»ç™‚æ©Ÿé–¢å—è¨ºä¸­</label>
    <input type="text" name="under_medical" value="{{ patient.under_medical or '' }}" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;" placeholder="åŒ»ç™‚æ©Ÿé–¢å—è¨ºã®æœ‰ç„¡">
  </div>
  
  <div style="margin-bottom: 20px;">
    <label class="form-field" style="display: block; margin-bottom: 6px; font-weight: 600; color: #1E3A5F;">é¼ç¸ã®å¥½ã¿</label>
    <input type="text" name="shinkyu_pref" value="{{ patient.shinkyu_pref or '' }}" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;" placeholder="é¼ç¸ã®å¥½ã¿">
  </div>
  
  <div style="margin-bottom: 20px;">
    <label class="form-field" style="display: block; margin-bottom: 6px; font-weight: 600; color: #1E3A5F;">é›»æ°—ã®å¥½ã¿</label>
    <input type="text" name="electric_pref" value="{{ patient.electric_pref or '' }}" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;" placeholder="é›»æ°—ã®å¥½ã¿">
  </div>
  
  <div style="margin-bottom: 20px;">
    <label class="form-field" style="display: block; margin-bottom: 6px; font-weight: 600; color: #1E3A5F;">åœ§åŠ›ã®å¥½ã¿</label>
    <input type="text" name="pressure_pref" value="{{ patient.pressure_pref or '' }}" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;" placeholder="åœ§åŠ›ã®å¥½ã¿">
  </div>
  
  <div style="margin-bottom: 20px;">
    <label class="form-field" style="display: block; margin-bottom: 6px; font-weight: 600; color: #1E3A5F;">åˆå›ç½²å</label>
    <input type="text" name="signature" value="{{ patient.signature or '' }}" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;" placeholder="ç½²å">
  </div>
  
  <div style="margin-bottom: 20px;">
    <label class="form-field" style="display: block; margin-bottom: 6px; font-weight: 600; color: #1E3A5F;">åˆå›åŒæ„æ—¥</label>
    <input type="date" name="agreed_at" value="{{ patient.agreed_at or '' }}" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;">
  </div>
  
  <div style="margin-bottom: 20px;">
    <label class="form-field" style="display: block; margin-bottom: 6px; font-weight: 600; color: #1E3A5F;">å‚™è€ƒ</label>
    <textarea name="note" rows="5" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;">{{ patient.note or '' }}</textarea>
  </div>
  
  <div style="display: flex; gap: 12px; margin-top: 30px;">
    <button type="submit" class="admin-karte-detail-btn-primary" style="border: none; cursor: pointer;">ğŸ’¾ æ›´æ–°</button>
    <a href="/admin/karte/{{ patient.id }}" class="admin-karte-detail-btn-back" style="text-decoration: none; display: inline-block; text-align: center;">â† è©³ç´°ã«æˆ»ã‚‹</a>
  </div>
</form>

{% endblock %}
